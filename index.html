<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ì—¬í–‰ AI Agent</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-800">
  <div class="max-w-4xl mx-auto p-6">
    <h1 class="text-3xl font-bold mb-2">ì—¬í–‰ AI Agent</h1>
    <p class="text-gray-600 mb-6">ìì—°ì–´ë¡œ ìš”ì²­í•˜ë©´ í•­ê³µ/í˜¸í…” ì¶”ì²œì„ ë³´ì—¬ì¤ë‹ˆë‹¤.</p>

    <textarea id="query" rows="3"
      class="w-full p-3 border rounded-lg mb-4"
      placeholder="ì˜ˆ) ì¸ì²œì—ì„œ ë„ì¿„ ì™•ë³µ, 11ì›” 2ì¼ ì¶œë°œ 11ì›” 4ì¼ ê·€êµ­, 2ë°•, ì„±ì¸ 2ëª…"></textarea>

    <button onclick="search()"
      class="px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700">
      ê²€ìƒ‰ ì‹¤í–‰
    </button>

    <div id="error" class="text-red-500 mt-4"></div>
    <div id="loading" class="text-indigo-600 mt-4 hidden">â³ ê²€ìƒ‰ ì¤‘...</div>

    <div id="results" class="grid md:grid-cols-3 gap-6 mt-6"></div>
  </div>

  <script>
    const API_BASE = "https://your-mcp-server.vercel.app/mcp"; // MCP ì„œë²„ ì£¼ì†Œ

    async function search() {
      const query = document.getElementById("query").value;
      const loading = document.getElementById("loading");
      const error = document.getElementById("error");
      const results = document.getElementById("results");

      loading.classList.remove("hidden");
      error.textContent = "";
      results.innerHTML = "";

      try {
        const res = await fetch(`${API_BASE}/query`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ prompt: query })
        });

        if (!res.ok) throw new Error("MCP ì„œë²„ í˜¸ì¶œ ì‹¤íŒ¨");
        const data = await res.json();

        const plans = [
          { key: "lowest", label: "ğŸ’° ìµœì €ê°€" },
          { key: "fastest", label: "âš¡ ìµœë‹¨ì‹œê°„" },
          { key: "safest", label: "ğŸ›¡ ìµœì†Œë¦¬ìŠ¤í¬" }
        ];

        plans.forEach(p => {
          const plan = data[p.key];
          if (!plan) return;
          const total = plan.flight.price +
            (plan.hotel.pricePerNight + plan.hotel.taxesPerNight) * (plan.hotel.nights || 1);

          results.innerHTML += `
            <div class="bg-white shadow-md rounded-xl p-4 flex flex-col">
              <h3 class="text-xl font-semibold mb-2">${p.label}</h3>
              <div class="border p-3 rounded-lg mb-3">
                <p class="font-bold">${plan.flight.airline?.name || "í•­ê³µí¸"}</p>
                <p class="text-sm">${plan.flight.origin} â†’ ${plan.flight.destination}</p>
                <p class="text-sm">ì¶œë°œ: ${plan.flight.departDate} ${plan.flight.departTime}</p>
                <p class="text-sm">ê·€êµ­: ${plan.flight.returnDate} ${plan.flight.returnTime}</p>
                <p class="font-semibold mt-1">â‚©${plan.flight.price.toLocaleString()}</p>
              </div>
              <div class="border p-3 rounded-lg mb-3">
                <p class="font-bold">${plan.hotel.name}</p>
                <p class="text-sm">ì§€ì—­: ${plan.hotel.area}</p>
                <p class="text-sm">ì²´í¬ì¸: ${plan.hotel.checkIn} ~ ${plan.hotel.checkOut}</p>
                <p class="font-semibold mt-1">
                  1ë°• â‚©${plan.hotel.pricePerNight.toLocaleString()} + ì„¸ê¸ˆ â‚©${plan.hotel.taxesPerNight.toLocaleString()}
                </p>
              </div>
              <div class="mt-auto pt-4">
                <button onclick="alert('ëª¨ì˜ ê²°ì œ ì™„ë£Œ!')"
                  class="w-full px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700">
                  ì˜ˆì•½ ì§„í–‰
                </button>
              </div>
              <p class="mt-2 font-bold">ì´ì•¡: â‚©${total.toLocaleString()}</p>
            </div>
          `;
        });
      } catch (err) {
        error.textContent = err.message;
      } finally {
        loading.classList.add("hidden");
      }
    }
  </script>
</body>
</html>
